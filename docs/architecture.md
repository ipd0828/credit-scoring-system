# Архитектура системы кредитного скоринга

## Обзор системы

Система кредитного скоринга представляет собой полнофункциональное ML-приложение, построенное с использованием микросервисной архитектуры и современных практик MLOps.

## Компоненты системы

### 1. Backend API (FastAPI)
- **Расположение**: `api/`
- **Порт**: 8000
- **Функции**:
  - RESTful API для предсказаний
  - Аутентификация и авторизация
  - Валидация входных данных
  - Обработка запросов и ответов

### 2. Frontend (Streamlit)
- **Расположение**: `frontend/`
- **Порт**: 8501
- **Функции**:
  - Веб-интерфейс для пользователей
  - Формы ввода данных
  - Визуализация результатов
  - Дашборды и аналитика

### 3. ML Pipeline
- **Расположение**: `app/services/`
- **Функции**:
  - Загрузка и предсказания моделей
  - Обработка признаков
  - Логирование предсказаний
  - Обратная связь для улучшения

### 4. База данных (PostgreSQL)
- **Порт**: 5432
- **Функции**:
  - Хранение данных о займах
  - Логирование предсказаний
  - Метаданные моделей
  - Пользовательские данные

### 5. Кэширование (Redis)
- **Порт**: 6379
- **Функции**:
  - Кэширование предсказаний
  - Сессии пользователей
  - Временные данные

### 6. Мониторинг
- **Prometheus**: Сбор метрик (порт 9090)
- **Grafana**: Дашборды (порт 3000)
- **Sentry**: Отслеживание ошибок

## Структура данных

### Входные данные
```json
{
  "annual_inc": 50000.0,
  "emp_length": "5 years",
  "home_ownership": "MORTGAGE",
  "loan_amnt": 10000.0,
  "term": "36 months",
  "purpose": "debt_consolidation",
  "fico_range_low": 700,
  "fico_range_high": 750,
  "dti": 15.5,
  "revol_util": 25.0,
  "inq_last_6mths": 2,
  "delinq_2yrs": 0,
  "pub_rec": 0
}
```

### Выходные данные
```json
{
  "success": true,
  "prediction": {
    "prediction": 0,
    "probability": 0.75,
    "confidence": "high",
    "recommended_amount": 10000.0,
    "risk_score": 25.0,
    "model_version": "1.0.0"
  },
  "processing_time_ms": 150.5,
  "request_id": "uuid",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

## Поток данных

1. **Пользователь** вводит данные через веб-интерфейс
2. **Frontend** отправляет запрос в **API**
3. **API** валидирует данные и передает в **ML Service**
4. **ML Service** загружает модель и делает предсказание
5. **Результат** возвращается через **API** в **Frontend**
6. **Данные** логируются в **Базу данных**
7. **Метрики** собираются **Prometheus**

## Безопасность

- JWT токены для аутентификации
- Валидация входных данных
- Rate limiting
- HTTPS в production
- Изоляция контейнеров

## Масштабируемость

- Горизонтальное масштабирование через Docker
- Load balancing
- Кэширование для производительности
- Асинхронная обработка

## Мониторинг и логирование

- Структурированные логи (JSON)
- Метрики производительности
- Health checks
- Алерты при проблемах
- Дашборды для визуализации

## Развертывание

- Docker контейнеризация
- Docker Compose для разработки
- Kubernetes для production
- CI/CD пайплайны
- Автоматическое тестирование

## Тестирование

- Unit тесты (80%+ покрытие)
- Integration тесты
- End-to-end тесты
- Нагрузочное тестирование
- Тестирование безопасности
