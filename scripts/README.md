# Скрипты для кредитного скоринга

Этот каталог содержит скрипты для полного пайплайна машинного обучения в проекте кредитного скоринга.

## Структура

```
scripts/
├── data_processing/          # Обработка данных
│   ├── eda.py               # Исследовательский анализ данных
│   └── preprocessing.py     # Предобработка данных
├── model_training/          # Обучение моделей
│   ├── train_models.py      # Обучение базовых моделей
│   ├── hyperparameter_tuning.py  # Подбор гиперпараметров
│   └── validation.py        # Валидация моделей
└── run_pipeline.py          # Главный скрипт для запуска всего пайплайна
```

## Быстрый старт

### Запуск полного пайплайна

```bash
# Запуск всех шагов
python scripts/run_pipeline.py

# Запуск конкретных шагов
python scripts/run_pipeline.py --steps eda preprocessing training

# Пропуск проверок
python scripts/run_pipeline.py --skip-checks
```

### Запуск отдельных скриптов

```bash
# 1. EDA
python scripts/data_processing/eda.py

# 2. Предобработка
python scripts/data_processing/preprocessing.py

# 3. Обучение моделей
python scripts/model_training/train_models.py

# 4. Подбор гиперпараметров
python scripts/model_training/hyperparameter_tuning.py

# 5. Валидация
python scripts/model_training/validation.py
```

## Описание скриптов

### 1. EDA (eda.py)

**Назначение**: Исследовательский анализ данных

**Функции**:
- Загрузка и анализ репрезентативности выборки
- Анализ целевой переменной
- Детальный EDA с использованием кастомного EDAProcessor
- Сохранение результатов анализа

**Входные данные**: `data/raw/accepted_2007_to_2018Q4.csv`

**Выходные данные**: 
- `data/processed/eda_processed_data.csv` - обработанные данные
- `data/processed/numeric_representativeness.csv` - анализ числовых признаков
- `data/processed/categorical_representativeness.csv` - анализ категориальных признаков

### 2. Предобработка (preprocessing.py)

**Назначение**: Предобработка данных для машинного обучения

**Функции**:
- Удаление столбцов с высоким процентом пропусков
- Удаление ненужных столбцов (ID, константные)
- Обработка пропущенных значений
- Создание препроцессора для числовых и категориальных признаков
- Разделение на обучающую и тестовую выборки

**Входные данные**: `data/processed/eda_processed_data.csv`

**Выходные данные**:
- `data/processed/X_train.csv` - обучающие признаки
- `data/processed/X_test.csv` - тестовые признаки
- `data/processed/y_train.csv` - обучающая целевая переменная
- `data/processed/y_test.csv` - тестовая целевая переменная
- `data/processed/preprocessor.pkl` - обученный препроцессор

### 3. Обучение моделей (train_models.py)

**Назначение**: Обучение базовых моделей машинного обучения

**Функции**:
- Обучение различных моделей (Logistic Regression, Random Forest, SVM)
- Оценка качества моделей
- Создание графиков сравнения
- Сохранение обученных моделей

**Входные данные**: Обработанные данные из preprocessing.py

**Выходные данные**:
- `models/trained/` - обученные модели
- `models/artifacts/model_comparison.png` - график сравнения моделей
- `models/artifacts/roc_curves.png` - ROC кривые
- `models/trained/model_results.csv` - результаты обучения

### 4. Подбор гиперпараметров (hyperparameter_tuning.py)

**Назначение**: Поиск оптимальных гиперпараметров для моделей

**Функции**:
- Определение сеток параметров для различных моделей
- Поиск лучших гиперпараметров с помощью GridSearchCV
- Оценка качества настроенных моделей
- Создание графиков анализа гиперпараметров

**Входные данные**: Обработанные данные

**Выходные данные**:
- `models/trained/tuned_*.pkl` - настроенные модели
- `models/artifacts/hyperparameter_analysis_*.png` - графики анализа параметров
- `models/artifacts/tuned_models_comparison.png` - сравнение настроенных моделей
- `models/trained/tuned_models_results.csv` - результаты подбора параметров

### 5. Валидация (validation.py)

**Назначение**: Валидация обученных моделей

**Функции**:
- Загрузка обученных моделей
- Валидация на тестовых данных
- Анализ производительности моделей
- Создание детальных отчетов о валидации
- Сравнение различных моделей

**Входные данные**: Обученные модели и тестовые данные

**Выходные данные**:
- `models/artifacts/validation_*.png` - графики валидации
- `models/artifacts/validation_report.csv` - CSV отчет
- `models/artifacts/validation_report.txt` - текстовый отчет

## Требования

Убедитесь, что установлены все зависимости:

```bash
pip install -r requirements.txt
```

## Настройка

1. Поместите файл данных `accepted_2007_to_2018Q4.csv` в папку `data/raw/`
2. Убедитесь, что все необходимые папки созданы
3. Запустите скрипты в правильном порядке

## Логирование

Все скрипты выводят подробную информацию о процессе выполнения:
- Прогресс выполнения
- Метрики качества
- Предупреждения и ошибки
- Время выполнения

## Обработка ошибок

Скрипты включают обработку ошибок и продолжают выполнение при возможных проблемах. В случае критических ошибок выполнение останавливается с соответствующим сообщением.

## Результаты

После выполнения всех скриптов вы получите:
- Обработанные данные готовые для машинного обучения
- Обученные и настроенные модели
- Детальные отчеты о качестве моделей
- Графики и визуализации для анализа

## Поддержка

При возникновении проблем проверьте:
1. Правильность путей к файлам данных
2. Установку всех зависимостей
3. Логи выполнения скриптов
4. Доступность необходимых папок
